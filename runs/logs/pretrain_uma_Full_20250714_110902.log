Forcing CPU for pretraining, unless APPLE fixes MPS support
================================================================================
ReconMAE Pretraining Script
================================================================================
Data path: ./data/ps2_p72/uma/snr10to25_speed5
Model: ReconMAE
Experiment: siso_1_umi_block_1_ps2_p72
Masking type: discrete
Epochs: 80
Learning rate: 0.001
Batch sizes: train=64, eval=64
================================================================================
Creating dataset with masking type: discrete
âœ… Dataset created successfully
âœ… Data loaders created: 507 train batches, 57 eval batches
âœ… Model hyperparameters loaded
âœ… Input shape determined: (2, 72, 2)
âœ… Model initialized successfully: ReconMAE
Model summary:
Model: "recon_mae"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 encoder (Encoder)           multiple                  125856    
                                                                 
 decoder (Decoder)           multiple                  27346     
                                                                 
 decoder_1 (Decoder)         multiple                  53074     
                                                                 
=================================================================
Total params: 206276 (805.77 KB)
Trainable params: 206276 (805.77 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________
ðŸš€ Starting training for ReconMAE...
Initial validation loss: 1.8460
Epoch 1/80
      1/Unknown - 1s 1s/step - loss: 1.8038      2/Unknown - 1s 233ms/step - loss: 1.5184      3/Unknown - 2s 239ms/step - loss: 1.3120      4/Unknown - 2s 238ms/step - loss: 1.1577      5/Unknown - 2s 236ms/step - loss: 1.0488      6/Unknown - 2s 234ms/step - loss: 0.9722      7/Unknown - 2s 233ms/step - loss: 0.9074      8/Unknown - 3s 233ms/step - loss: 0.8508      9/Unknown - 3s 232ms/step - loss: 0.8077     10/Unknown - 3s 231ms/step - loss: 0.7744     11/Unknown - 3s 231ms/step - loss: 0.7435     12/Unknown - 4s 230ms/step - loss: 0.7163     13/Unknown - 4s 229ms/step - loss: 0.6911     14/Unknown - 4s 229ms/step - loss: 0.6703     15/Unknown - 4s 231ms/step - loss: 0.6510     16/Unknown - 5s 235ms/step - loss: 0.6356     17/Unknown - 5s 236ms/step - loss: 0.6213     18/Unknown - 5s 237ms/step - loss: 0.6061     19/Unknown - 5s 237ms/step - loss: 0.5921     20/Unknown - 6s 237ms/step - loss: 0.5802     21/Unknown - 6s 236ms/step - loss: 0.5689     22/Unknown - 6s 236ms/step - loss: 0.5573     23/Unknown - 6s 237ms/step - loss: 0.5464     24/Unknown - 7s 237ms/step - loss: 0.5365     25/Unknown - 7s 237ms/step - loss: 0.5265     26/Unknown - 7s 237ms/step - loss: 0.5175     27/Unknown - 7s 237ms/step - loss: 0.5089     28/Unknown - 7s 236ms/step - loss: 0.4999     29/Unknown - 8s 236ms/step - loss: 0.4915     30/Unknown - 8s 236ms/step - loss: 0.4826     31/Unknown - 8s 236ms/step - loss: 0.4739     32/Unknown - 8s 236ms/step - loss: 0.4665     33/Unknown - 9s 235ms/step - loss: 0.4593     34/Unknown - 9s 235ms/step - loss: 0.4519     35/Unknown - 9s 235ms/step - loss: 0.4450     36/Unknown - 9s 235ms/step - loss: 0.4385     37/Unknown - 10s 235ms/step - loss: 0.4324     38/Unknown - 10s 234ms/step - loss: 0.4262     39/Unknown - 10s 234ms/step - loss: 0.4206     40/Unknown - 10s 234ms/step - loss: 0.4149     41/Unknown - 10s 234ms/step - loss: 0.4094     42/Unknown - 11s 234ms/step - loss: 0.4042     43/Unknown - 11s 234ms/step - loss: 0.3992     44/Unknown - 11s 233ms/step - loss: 0.3943     45/Unknown - 11s 235ms/step - loss: 0.3897     46/Unknown - 12s 234ms/step - loss: 0.3851     47/Unknown - 12s 234ms/step - loss: 0.3806     48/Unknown - 12s 234ms/step - loss: 0.3764     49/Unknown - 12s 234ms/step - loss: 0.3720     50/Unknown - 13s 234ms/step - loss: 0.3677     51/Unknown - 13s 234ms/step - loss: 0.3637     52/Unknown - 13s 234ms/step - loss: 0.3602     53/Unknown - 13s 234ms/step - loss: 0.3564     54/Unknown - 13s 234ms/step - loss: 0.3529     55/Unknown - 14s 234ms/step - loss: 0.3495     56/Unknown - 14s 234ms/step - loss: 0.3460     57/Unknown - 14s 234ms/step - loss: 0.3427     58/Unknown - 14s 234ms/step - loss: 0.3393     59/Unknown - 15s 234ms/step - loss: 0.3363     60/Unknown - 15s 234ms/step - loss: 0.3330     61/Unknown - 15s 233ms/step - loss: 0.3300     62/Unknown - 15s 233ms/step - loss: 0.3270     63/Unknown - 16s 233ms/step - loss: 0.3241     64/Unknown - 16s 233ms/step - loss: 0.3212     65/Unknown - 16s 233ms/step - loss: 0.3183     66/Unknown - 16s 233ms/step - loss: 0.3156     67/Unknown - 16s 233ms/step - loss: 0.3130     68/Unknown - 17s 233ms/step - loss: 0.3102     69/Unknown - 17s 233ms/step - loss: 0.3075     70/Unknown - 17s 233ms/step - loss: 0.3049     71/Unknown - 17s 232ms/step - loss: 0.3024     72/Unknown - 18s 232ms/step - loss: 0.3001     73/Unknown - 18s 232ms/step - loss: 0.2977     74/Unknown - 18s 232ms/step - loss: 0.2955     75/Unknown - 18s 232ms/step - loss: 0.2932     76/Unknown - 19s 232ms/step - loss: 0.2911     77/Unknown - 19s 232ms/step - loss: 0.2890     78/Unknown - 19s 232ms/step - loss: 0.2870     79/Unknown - 19s 232ms/step - loss: 0.2848     80/Unknown - 19s 232ms/step - loss: 0.2829     81/Unknown - 20s 232ms/step - loss: 0.2810     82/Unknown - 20s 232ms/step - loss: 0.2790     83/Unknown - 20s 232ms/step - loss: 0.2771     84/Unknown - 20s 232ms/step - loss: 0.2751     85/Unknown - 21s 232ms/step - loss: 0.2733     86/Unknown - 21s 232ms/step - loss: 0.2713     87/Unknown - 21s 233ms/step - loss: 0.2695     88/Unknown - 21s 233ms/step - loss: 0.2677     89/Unknown - 22s 233ms/step - loss: 0.2659     90/Unknown - 22s 233ms/step - loss: 0.2641     91/Unknown - 22s 233ms/step - loss: 0.2623     92/Unknown - 22s 233ms/step - loss: 0.2605     93/Unknown - 22s 233ms/step - loss: 0.2588     94/Unknown - 23s 233ms/step - loss: 0.2572     95/Unknown - 23s 233ms/step - loss: 0.2557     96/Unknown - 23s 232ms/step - loss: 0.2541     97/Unknown - 23s 232ms/step - loss: 0.2526     98/Unknown - 24s 232ms/step - loss: 0.2511     99/Unknown - 24s 234ms/step - loss: 0.2495    100/Unknown - 24s 234ms/step - loss: 0.2481    101/Unknown - 24s 233ms/step - loss: 0.2466    102/Unknown - 25s 233ms/step - loss: 0.2451    103/Unknown - 25s 234ms/step - loss: 0.2437    104/Unknown - 25s 234ms/step - loss: 0.2424    105/Unknown - 25s 235ms/step - loss: 0.2409    106/Unknown - 26s 235ms/step - loss: 0.2395    107/Unknown - 26s 235ms/step - loss: 0.2382    108/Unknown - 26s 235ms/step - loss: 0.2369    109/Unknown - 26s 235ms/step - loss: 0.2356    110/Unknown - 27s 235ms/step - loss: 0.2343    111/Unknown - 27s 235ms/step - loss: 0.2331    112/Unknown - 27s 236ms/step - loss: 0.2318    113/Unknown - 28s 236ms/step - loss: 0.2305    114/Unknown - 28s 236ms/step - loss: 0.2293    115/Unknown - 28s 236ms/step - loss: 0.2281    116/Unknown - 28s 235ms/step - loss: 0.2270    117/Unknown - 28s 235ms/step - loss: 0.2258    118/Unknown - 29s 235ms/step - loss: 0.2247    119/Unknown - 29s 235ms/step - loss: 0.2236    120/Unknown - 29s 235ms/step - loss: 0.2223    121/Unknown - 29s 235ms/step - loss: 0.2212    122/Unknown - 29s 234ms/step - loss: 0.2201    123/Unknown - 30s 234ms/step - loss: 0.2190    124/Unknown - 30s 234ms/step - loss: 0.2180