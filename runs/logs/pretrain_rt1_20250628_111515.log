GPU devices found:
  PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')
✅ GPU acceleration enabled (MPS)
================================================================================
ReconMAE Pretraining Script
================================================================================
Data path: ./data/ps2_p72/rt1/snr10to25_speed5
Model: ReconMAE
Experiment: siso_1_umi_block_1_ps2_p72
Masking type: discrete
Epochs: 1
Learning rate: 0.001
Batch sizes: train=64, eval=64
================================================================================
Creating dataset with masking type: discrete
✅ Dataset created successfully
✅ Data loaders created: 507 train batches, 57 eval batches
✅ Model hyperparameters loaded
✅ Input shape determined: (2, 72, 2)
✅ Model initialized successfully
Model summary:
Model: "recon_mae"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 encoder (Encoder)           multiple                  125856    
                                                                 
 decoder (Decoder)           multiple                  27346     
                                                                 
 decoder_1 (Decoder)         multiple                  53074     
                                                                 
=================================================================
Total params: 206276 (805.77 KB)
Trainable params: 206276 (805.77 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________
🚀 Starting training...
Initial validation loss: 1.6744
      1/Unknown - 1s 1s/step - loss: 1.7235      2/Unknown - 1s 65ms/step - loss: 1.6124      4/Unknown - 2s 51ms/step - loss: 1.2819      6/Unknown - 2s 47ms/step - loss: 1.0686      8/Unknown - 2s 46ms/step - loss: 0.9412     10/Unknown - 2s 45ms/step - loss: 0.8607     12/Unknown - 2s 44ms/step - loss: 0.8009     14/Unknown - 2s 44ms/step - loss: 0.7570     16/Unknown - 2s 43ms/step - loss: 0.7175     18/Unknown - 2s 43ms/step - loss: 0.6880     20/Unknown - 2s 43ms/step - loss: 0.6633     22/Unknown - 2s 43ms/step - loss: 0.6414     24/Unknown - 2s 43ms/step - loss: 0.6234     26/Unknown - 2s 42ms/step - loss: 0.6045     28/Unknown - 3s 42ms/step - loss: 0.5909     30/Unknown - 3s 42ms/step - loss: 0.5769     32/Unknown - 3s 42ms/step - loss: 0.5651     34/Unknown - 3s 42ms/step - loss: 0.5544     36/Unknown - 3s 42ms/step - loss: 0.5447     38/Unknown - 3s 42ms/step - loss: 0.5358     40/Unknown - 3s 42ms/step - loss: 0.5273     42/Unknown - 3s 42ms/step - loss: 0.5189     44/Unknown - 3s 42ms/step - loss: 0.5120     46/Unknown - 3s 42ms/step - loss: 0.5051     48/Unknown - 3s 42ms/step - loss: 0.4979     50/Unknown - 3s 42ms/step - loss: 0.4917     52/Unknown - 4s 42ms/step - loss: 0.4854     54/Unknown - 4s 42ms/step - loss: 0.4792     56/Unknown - 4s 42ms/step - loss: 0.4736     58/Unknown - 4s 42ms/step - loss: 0.4677     60/Unknown - 4s 42ms/step - loss: 0.4620     62/Unknown - 4s 42ms/step - loss: 0.4560     64/Unknown - 4s 42ms/step - loss: 0.4500     66/Unknown - 4s 42ms/step - loss: 0.4439     68/Unknown - 4s 42ms/step - loss: 0.4378     70/Unknown - 4s 42ms/step - loss: 0.4314     72/Unknown - 4s 42ms/step - loss: 0.4257     74/Unknown - 4s 42ms/step - loss: 0.4199     76/Unknown - 5s 42ms/step - loss: 0.4142     78/Unknown - 5s 42ms/step - loss: 0.4089     80/Unknown - 5s 42ms/step - loss: 0.4038     82/Unknown - 5s 42ms/step - loss: 0.3987     84/Unknown - 5s 42ms/step - loss: 0.3940     86/Unknown - 5s 42ms/step - loss: 0.3890     88/Unknown - 5s 42ms/step - loss: 0.3842     90/Unknown - 5s 42ms/step - loss: 0.3792     92/Unknown - 5s 42ms/step - loss: 0.3743     94/Unknown - 5s 42ms/step - loss: 0.3694     96/Unknown - 5s 42ms/step - loss: 0.3648     98/Unknown - 5s 42ms/step - loss: 0.3600    100/Unknown - 6s 42ms/step - loss: 0.3552    102/Unknown - 6s 41ms/step - loss: 0.3507    104/Unknown - 6s 41ms/step - loss: 0.3461    106/Unknown - 6s 41ms/step - loss: 0.3416    108/Unknown - 6s 41ms/step - loss: 0.3371    110/Unknown - 6s 41ms/step - loss: 0.3328    112/Unknown - 6s 41ms/step - loss: 0.3285    114/Unknown - 6s 41ms/step - loss: 0.3243    116/Unknown - 6s 41ms/step - loss: 0.3201    118/Unknown - 6s 41ms/step - loss: 0.3161    120/Unknown - 6s 41ms/step - loss: 0.3122    122/Unknown - 6s 41ms/step - loss: 0.3084    124/Unknown - 6s 41ms/step - loss: 0.3046    125/Unknown - 7s 42ms/step - loss: 0.3027    127/Unknown - 7s 41ms/step - loss: 0.2992    129/Unknown - 7s 41ms/step - loss: 0.2957    131/Unknown - 7s 41ms/step - loss: 0.2922    133/Unknown - 7s 41ms/step - loss: 0.2888    135/Unknown - 7s 41ms/step - loss: 0.2855    137/Unknown - 7s 41ms/step - loss: 0.2822    139/Unknown - 7s 41ms/step - loss: 0.2790    141/Unknown - 7s 41ms/step - loss: 0.2759    143/Unknown - 7s 41ms/step - loss: 0.2729    145/Unknown - 7s 41ms/step - loss: 0.2700    147/Unknown - 7s 41ms/step - loss: 0.2670    149/Unknown - 8s 41ms/step - loss: 0.2642    151/Unknown - 8s 41ms/step - loss: 0.2614    153/Unknown - 8s 41ms/step - loss: 0.2586    155/Unknown - 8s 41ms/step - loss: 0.2560    157/Unknown - 8s 41ms/step - loss: 0.2535    159/Unknown - 8s 41ms/step - loss: 0.2510    161/Unknown - 8s 41ms/step - loss: 0.2485    163/Unknown - 8s 41ms/step - loss: 0.2461    165/Unknown - 8s 41ms/step - loss: 0.2437    167/Unknown - 8s 41ms/step - loss: 0.2414    169/Unknown - 8s 41ms/step - loss: 0.2391    171/Unknown - 8s 41ms/step - loss: 0.2368    173/Unknown - 9s 41ms/step - loss: 0.2347    175/Unknown - 9s 41ms/step - loss: 0.2325    177/Unknown - 9s 41ms/step - loss: 0.2304    179/Unknown - 9s 41ms/step - loss: 0.2284    181/Unknown - 9s 41ms/step - loss: 0.2264    183/Unknown - 9s 41ms/step - loss: 0.2244    185/Unknown - 9s 41ms/step - loss: 0.2224    187/Unknown - 9s 41ms/step - loss: 0.2205    189/Unknown - 9s 41ms/step - loss: 0.2186    191/Unknown - 9s 41ms/step - loss: 0.2168    193/Unknown - 9s 41ms/step - loss: 0.2150    195/Unknown - 9s 41ms/step - loss: 0.2132    197/Unknown - 10s 41ms/step - loss: 0.2115    199/Unknown - 10s 41ms/step - loss: 0.2098    201/Unknown - 10s 41ms/step - loss: 0.2081    203/Unknown - 10s 41ms/step - loss: 0.2065    205/Unknown - 10s 41ms/step - loss: 0.2048    207/Unknown - 10s 41ms/step - loss: 0.2032    209/Unknown - 10s 41ms/step - loss: 0.2016    211/Unknown - 10s 41ms/step - loss: 0.2001    213/Unknown - 10s 41ms/step - loss: 0.1985    215/Unknown - 10s 41ms/step - loss: 0.1971    217/Unknown - 10s 41ms/step - loss: 0.1956    219/Unknown - 10s 41ms/step - loss: 0.1942    221/Unknown - 11s 41ms/step - loss: 0.1928    223/Unknown - 11s 41ms/step - loss: 0.1914    225/Unknown - 11s 41ms/step - loss: 0.1900    227/Unknown - 11s 41ms/step - loss: 0.1887    229/Unknown - 11s 41ms/step - loss: 0.1873    231/Unknown - 11s 41ms/step - loss: 0.1860    233/Unknown - 11s 41ms/step - loss: 0.1847    235/Unknown - 11s 41ms/step - loss: 0.1835    237/Unknown - 11s 41ms/step - loss: 0.1822    239/Unknown - 11s 41ms/step - loss: 0.1810    241/Unknown - 11s 41ms/step - loss: 0.1798    243/Unknown - 11s 41ms/step - loss: 0.1786    245/Unknown - 12s 41ms/step - loss: 0.1774    247/Unknown - 12s 41ms/step - loss: 0.1763    249/Unknown - 12s 41ms/step - loss: 0.1752    251/Unknown - 12s 41ms/step - loss: 0.1740    253/Unknown - 12s 41ms/step - loss: 0.1729    255/Unknown - 12s 41ms/step - loss: 0.1718    257/Unknown - 12s 41ms/step - loss: 0.1708    259/Unknown - 12s 41ms/step - loss: 0.1697    261/Unknown - 12s 41ms/step - loss: 0.1686    263/Unknown - 12s 41ms/step - loss: 0.1676    265/Unknown - 12s 41ms/step - loss: 0.1666    267/Unknown - 12s 41ms/step - loss: 0.1656    269/Unknown - 13s 41ms/step - loss: 0.1646    271/Unknown - 13s 41ms/step - loss: 0.1637    273/Unknown - 13s 41ms/step - loss: 0.1627    275/Unknown - 13s 41ms/step - loss: 0.1618    277/Unknown - 13s 41ms/step - loss: 0.1609    279/Unknown - 13s 41ms/step - loss: 0.1599    281/Unknown - 13s 41ms/step - loss: 0.1590    283/Unknown - 13s 41ms/step - loss: 0.1581    285/Unknown - 13s 42ms/step - loss: 0.1573    286/Unknown - 13s 42ms/step - loss: 0.1568    287/Unknown - 13s 42ms/step - loss: 0.1564    288/Unknown - 13s 42ms/step - loss: 0.1560    289/Unknown - 14s 42ms/step - loss: 0.1555    291/Unknown - 14s 42ms/step - loss: 0.1547    292/Unknown - 14s 42ms/step - loss: 0.1543    294/Unknown - 14s 42ms/step - loss: 0.1534    295/Unknown - 14s 42ms/step - loss: 0.1530    296/Unknown - 14s 42ms/step - loss: 0.1526    298/Unknown - 14s 42ms/step - loss: 0.1518    299/Unknown - 14s 42ms/step - loss: 0.1514    300/Unknown - 14s 42ms/step - loss: 0.1510    302/Unknown - 14s 42ms/step - loss: 0.1502    303/Unknown - 14s 42ms/step - loss: 0.1498    305/Unknown - 14s 42ms/step - loss: 0.1491    307/Unknown - 14s 42ms/step - loss: 0.1483    309/Unknown - 14s 42ms/step - loss: 0.1475    311/Unknown - 15s 42ms/step - loss: 0.1468    313/Unknown - 15s 42ms/step - loss: 0.1461    315/Unknown - 15s 42ms/step - loss: 0.1454    317/Unknown - 15s 42ms/step - loss: 0.1447    319/Unknown - 15s 42ms/step - loss: 0.1440    321/Unknown - 15s 42ms/step - loss: 0.1433    323/Unknown - 15s 42ms/step - loss: 0.1426    325/Unknown - 15s 42ms/step - loss: 0.1419    327/Unknown - 15s 42ms/step - loss: 0.1412    329/Unknown - 15s 42ms/step - loss: 0.1405    331/Unknown - 15s 42ms/step - loss: 0.1399    333/Unknown - 16s 42ms/step - loss: 0.1392    335/Unknown - 16s 42ms/step - loss: 0.1386    337/Unknown - 16s 42ms/step - loss: 0.1379    339/Unknown - 16s 42ms/step - loss: 0.1373    341/Unknown - 16s 42ms/step - loss: 0.1367    343/Unknown - 16s 42ms/step - loss: 0.1360    345/Unknown - 16s 42ms/step - loss: 0.1354    347/Unknown - 16s 42ms/step - loss: 0.1348    349/Unknown - 16s 42ms/step - loss: 0.1342    351/Unknown - 16s 42ms/step - loss: 0.1336    353/Unknown - 16s 42ms/step - loss: 0.1330    355/Unknown - 16s 42ms/step - loss: 0.1324    357/Unknown - 17s 42ms/step - loss: 0.1318    359/Unknown - 17s 42ms/step - loss: 0.1313    361/Unknown - 17s 42ms/step - loss: 0.1307    363/Unknown - 17s 42ms/step - loss: 0.1301    365/Unknown - 17s 42ms/step - loss: 0.1296    366/Unknown - 17s 42ms/step - loss: 0.1293    367/Unknown - 17s 43ms/step - loss: 0.1290    368/Unknown - 17s 43ms/step - loss: 0.1288    370/Unknown - 17s 43ms/step - loss: 0.1282    372/Unknown - 17s 43ms/step - loss: 0.1277    373/Unknown - 17s 43ms/step - loss: 0.1274    375/Unknown - 17s 43ms/step - loss: 0.1269    377/Unknown - 17s 43ms/step - loss: 0.1264    379/Unknown - 18s 43ms/step - loss: 0.1258    381/Unknown - 18s 43ms/step - loss: 0.1253    383/Unknown - 18s 43ms/step - loss: 0.1248    385/Unknown - 18s 43ms/step - loss: 0.1243    387/Unknown - 18s 43ms/step - loss: 0.1238    389/Unknown - 18s 43ms/step - loss: 0.1233    391/Unknown - 18s 43ms/step - loss: 0.1229    393/Unknown - 18s 43ms/step - loss: 0.1224    395/Unknown - 18s 43ms/step - loss: 0.1219    397/Unknown - 18s 43ms/step - loss: 0.1214    399/Unknown - 18s 43ms/step - loss: 0.1210    401/Unknown - 18s 43ms/step - loss: 0.1205    403/Unknown - 19s 43ms/step - loss: 0.1201    405/Unknown - 19s 43ms/step - loss: 0.1196    407/Unknown - 19s 43ms/step - loss: 0.1191    409/Unknown - 19s 43ms/step - loss: 0.1187    411/Unknown - 19s 43ms/step - loss: 0.1183    413/Unknown - 19s 43ms/step - loss: 0.1178    415/Unknown - 19s 43ms/step - loss: 0.1174    417/Unknown - 19s 43ms/step - loss: 0.1169    419/Unknown - 19s 43ms/step - loss: 0.1165    421/Unknown - 19s 43ms/step - loss: 0.1161    423/Unknown - 19s 43ms/step - loss: 0.1157    425/Unknown - 19s 43ms/step - loss: 0.1153    427/Unknown - 20s 43ms/step - loss: 0.1148    429/Unknown - 20s 43ms/step - loss: 0.1144    431/Unknown - 20s 42ms/step - loss: 0.1140    433/Unknown - 20s 42ms/step - loss: 0.1136    435/Unknown - 20s 42ms/step - loss: 0.1132    437/Unknown - 20s 42ms/step - loss: 0.1128    439/Unknown - 20s 42ms/step - loss: 0.1124    441/Unknown - 20s 42ms/step - loss: 0.1120    443/Unknown - 20s 42ms/step - loss: 0.1116    445/Unknown - 20s 43ms/step - loss: 0.1112    447/Unknown - 20s 43ms/step - loss: 0.1109    449/Unknown - 20s 43ms/step - loss: 0.1105    451/Unknown - 21s 43ms/step - loss: 0.1101    453/Unknown - 21s 43ms/step - loss: 0.1097    455/Unknown - 21s 43ms/step - loss: 0.1094    457/Unknown - 21s 43ms/step - loss: 0.1090    459/Unknown - 21s 43ms/step - loss: 0.1086    461/Unknown - 21s 42ms/step - loss: 0.1082    463/Unknown - 21s 42ms/step - loss: 0.1079    465/Unknown - 21s 42ms/step - loss: 0.1075    467/Unknown - 21s 42ms/step - loss: 0.1072    469/Unknown - 21s 42ms/step - loss: 0.1068    471/Unknown - 21s 42ms/step - loss: 0.1065    473/Unknown - 21s 42ms/step - loss: 0.1061    475/Unknown - 22s 42ms/step - loss: 0.1058    477/Unknown - 22s 42ms/step - loss: 0.1055    479/Unknown - 22s 42ms/step - loss: 0.1051    481/Unknown - 22s 42ms/step - loss: 0.1048    483/Unknown - 22s 42ms/step - loss: 0.1045    485/Unknown - 22s 42ms/step - loss: 0.1041    487/Unknown - 22s 42ms/step - loss: 0.1038    489/Unknown - 22s 42ms/step - loss: 0.1035    490/Unknown - 22s 42ms/step - loss: 0.1033    492/Unknown - 22s 42ms/step - loss: 0.1030    494/Unknown - 22s 42ms/step - loss: 0.1027    496/Unknown - 22s 42ms/step - loss: 0.1024    498/Unknown - 23s 42ms/step - loss: 0.1021    500/Unknown - 23s 42ms/step - loss: 0.1017    502/Unknown - 23s 42ms/step - loss: 0.1014    504/Unknown - 23s 42ms/step - loss: 0.1011    506/Unknown - 23s 42ms/step - loss: 0.1008    507/Unknown - 23s 43ms/step - loss: 0.1008
Epoch 1: val_loss improved from inf to 0.02437, saving model to ./model_output/ReconMAE_20250628_111528/cp.ckpt
507/507 [==============================] - 25s 46ms/step - loss: 0.1008 - val_loss: 0.0244 - lr: 0.0010
Loaded best weights from checkpoint before saving .h5 file
Converting weights to CPU format for cross-platform compatibility...
✅ CPU-compatible weights saved to:
   ./model_output/ReconMAE_20250628_111528/rt1.h5
   ./model_output/ReconMAE_20250628_111528/rt1_cpu.h5
✅ Training completed successfully!
📁 Model saved in: ./model_output/ReconMAE_20250628_111528
💾 Weights file: rt1.h5
📊 Final training loss: 0.10078111290931702
📊 Final validation loss: 0.024368736892938614
