Forcing CPU for pretraining, unless APPLE fixes MPS support
================================================================================
ReconMAE Pretraining Script
================================================================================
Data path: ./data/ps2_p72/rt0/snr10to25_speed5
Model: ReconMAE_MainOnly
Experiment: siso_1_umi_block_1_ps2_p72
Masking type: discrete
Epochs: 80
Learning rate: 0.001
Batch sizes: train=64, eval=64
================================================================================
Creating dataset with masking type: discrete
âœ… Dataset created successfully
âœ… Data loaders created: 507 train batches, 57 eval batches
âœ… Model hyperparameters loaded
âœ… Input shape determined: (2, 72, 2)
âœ… Model initialized successfully: ReconMAE_MainOnly
Model summary:
Model: "recon_mae__main_only"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 encoder (Encoder)           multiple                  125856    
                                                                 
 batch_normalization (Batch  multiple                  0 (unused)
 Normalization)                                                  
                                                                 
 layer_normalization_2 (Lay  multiple                  0 (unused)
 erNormalization)                                                
                                                                 
 decoder (Decoder)           multiple                  53074     
                                                                 
=================================================================
Total params: 178930 (698.95 KB)
Trainable params: 178930 (698.95 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________
ðŸš€ Starting training for ReconMAE_MainOnly...
Initial validation loss: 1.1060
Epoch 1/80
      1/Unknown - 1s 775ms/step - loss: 1.0939      2/Unknown - 1s 142ms/step - loss: 0.9944      3/Unknown - 1s 144ms/step - loss: 0.9418      4/Unknown - 1s 143ms/step - loss: 0.8874      5/Unknown - 1s 145ms/step - loss: 0.8537      6/Unknown - 1s 144ms/step - loss: 0.8257      7/Unknown - 2s 144ms/step - loss: 0.8004      8/Unknown - 2s 143ms/step - loss: 0.7833      9/Unknown - 2s 143ms/step - loss: 0.7674     10/Unknown - 2s 142ms/step - loss: 0.7552     11/Unknown - 2s 142ms/step - loss: 0.7457     12/Unknown - 2s 142ms/step - loss: 0.7357     13/Unknown - 2s 142ms/step - loss: 0.7262     14/Unknown - 3s 142ms/step - loss: 0.7180     15/Unknown - 3s 142ms/step - loss: 0.7112     16/Unknown - 3s 143ms/step - loss: 0.7052     17/Unknown - 3s 143ms/step - loss: 0.7000     18/Unknown - 3s 145ms/step - loss: 0.6931     19/Unknown - 3s 146ms/step - loss: 0.6874     20/Unknown - 4s 147ms/step - loss: 0.6799     21/Unknown - 4s 147ms/step - loss: 0.6748     22/Unknown - 4s 147ms/step - loss: 0.6681     23/Unknown - 4s 148ms/step - loss: 0.6615     24/Unknown - 4s 148ms/step - loss: 0.6559     25/Unknown - 4s 148ms/step - loss: 0.6496     26/Unknown - 4s 148ms/step - loss: 0.6448     27/Unknown - 5s 149ms/step - loss: 0.6392     28/Unknown - 5s 148ms/step - loss: 0.6328     29/Unknown - 5s 149ms/step - loss: 0.6263     30/Unknown - 5s 149ms/step - loss: 0.6191     31/Unknown - 5s 149ms/step - loss: 0.6138     32/Unknown - 5s 149ms/step - loss: 0.6073     33/Unknown - 6s 149ms/step - loss: 0.6017     34/Unknown - 6s 149ms/step - loss: 0.5960     35/Unknown - 6s 148ms/step - loss: 0.5902     36/Unknown - 6s 148ms/step - loss: 0.5840     37/Unknown - 6s 148ms/step - loss: 0.5782     38/Unknown - 6s 148ms/step - loss: 0.5727     39/Unknown - 6s 148ms/step - loss: 0.5668     40/Unknown - 7s 148ms/step - loss: 0.5611     41/Unknown - 7s 148ms/step - loss: 0.5553     42/Unknown - 7s 148ms/step - loss: 0.5498     43/Unknown - 7s 148ms/step - loss: 0.5442     44/Unknown - 7s 148ms/step - loss: 0.5384     45/Unknown - 7s 148ms/step - loss: 0.5328     46/Unknown - 7s 148ms/step - loss: 0.5274     47/Unknown - 8s 150ms/step - loss: 0.5221     48/Unknown - 8s 151ms/step - loss: 0.5171     49/Unknown - 8s 151ms/step - loss: 0.5109     50/Unknown - 8s 151ms/step - loss: 0.5061     51/Unknown - 8s 151ms/step - loss: 0.5003     52/Unknown - 9s 152ms/step - loss: 0.4950     53/Unknown - 9s 152ms/step - loss: 0.4901     54/Unknown - 9s 152ms/step - loss: 0.4848     55/Unknown - 9s 152ms/step - loss: 0.4793     56/Unknown - 9s 152ms/step - loss: 0.4744     57/Unknown - 9s 152ms/step - loss: 0.4690     58/Unknown - 9s 152ms/step - loss: 0.4641     59/Unknown - 10s 152ms/step - loss: 0.4590     60/Unknown - 10s 152ms/step - loss: 0.4546     61/Unknown - 10s 152ms/step - loss: 0.4496     62/Unknown - 10s 152ms/step - loss: 0.4449     63/Unknown - 10s 152ms/step - loss: 0.4404     64/Unknown - 10s 152ms/step - loss: 0.4355     65/Unknown - 10s 152ms/step - loss: 0.4311     66/Unknown - 11s 152ms/step - loss: 0.4266     67/Unknown - 11s 152ms/step - loss: 0.4224     68/Unknown - 11s 151ms/step - loss: 0.4183     69/Unknown - 11s 151ms/step - loss: 0.4140     70/Unknown - 11s 151ms/step - loss: 0.4100     71/Unknown - 11s 152ms/step - loss: 0.4059     72/Unknown - 12s 152ms/step - loss: 0.4020     73/Unknown - 12s 152ms/step - loss: 0.3979     74/Unknown - 12s 152ms/step - loss: 0.3941     75/Unknown - 12s 152ms/step - loss: 0.3903     76/Unknown - 12s 152ms/step - loss: 0.3866     77/Unknown - 12s 152ms/step - loss: 0.3835     78/Unknown - 12s 152ms/step - loss: 0.3800     79/Unknown - 13s 152ms/step - loss: 0.3767     80/Unknown - 13s 152ms/step - loss: 0.3731     81/Unknown - 13s 152ms/step - loss: 0.3700     82/Unknown - 13s 153ms/step - loss: 0.3667     83/Unknown - 13s 153ms/step - loss: 0.3636     84/Unknown - 13s 153ms/step - loss: 0.3605     85/Unknown - 14s 153ms/step - loss: 0.3575     86/Unknown - 14s 153ms/step - loss: 0.3545     87/Unknown - 14s 153ms/step - loss: 0.3516     88/Unknown - 14s 153ms/step - loss: 0.3488     89/Unknown - 14s 153ms/step - loss: 0.3461     90/Unknown - 14s 153ms/step - loss: 0.3434     91/Unknown - 15s 153ms/step - loss: 0.3410     92/Unknown - 15s 153ms/step - loss: 0.3384     93/Unknown - 15s 153ms/step - loss: 0.3362     94/Unknown - 15s 153ms/step - loss: 0.3338     95/Unknown - 15s 153ms/step - loss: 0.3313     96/Unknown - 15s 153ms/step - loss: 0.3290     97/Unknown - 15s 153ms/step - loss: 0.3265     98/Unknown - 16s 153ms/step - loss: 0.3242     99/Unknown - 16s 153ms/step - loss: 0.3217    100/Unknown - 16s 154ms/step - loss: 0.3194    101/Unknown - 16s 154ms/step - loss: 0.3172    102/Unknown - 16s 154ms/step - loss: 0.3149    103/Unknown - 17s 154ms/step - loss: 0.3127    104/Unknown - 17s 155ms/step - loss: 0.3107    105/Unknown - 17s 155ms/step - loss: 0.3085    106/Unknown - 17s 156ms/step - loss: 0.3065    107/Unknown - 17s 156ms/step - loss: 0.3045    108/Unknown - 17s 156ms/step - loss: 0.3025    109/Unknown - 18s 156ms/step - loss: 0.3005    110/Unknown - 18s 156ms/step - loss: 0.2985    111/Unknown - 18s 156ms/step - loss: 0.2966    112/Unknown - 18s 157ms/step - loss: 0.2946    113/Unknown - 18s 157ms/step - loss: 0.2928    114/Unknown - 19s 158ms/step - loss: 0.2910    115/Unknown - 19s 158ms/step - loss: 0.2894    116/Unknown - 19s 158ms/step - loss: 0.2876    117/Unknown - 19s 159ms/step - loss: 0.2859    118/Unknown - 19s 159ms/step - loss: 0.2841    119/Unknown - 19s 159ms/step - loss: 0.2825    120/Unknown - 20s 159ms/step - loss: 0.2808    121/Unknown - 20s 159ms/step - loss: 0.2792    122/Unknown - 20s 159ms/step - loss: 0.2775    123/Unknown - 20s 159ms/step - loss: 0.2760    124/Unknown - 20s 159ms/step - loss: 0.2745    125/Unknown - 20s 159ms/step - loss: 0.2730    126/Unknown - 21s 159ms/step - loss: 0.2715    127/Unknown - 21s 159ms/step - loss: 0.2701    128/Unknown - 21s 159ms/step - loss: 0.2686    129/Unknown - 21s 159ms/step - loss: 0.2674    130/Unknown - 21s 159ms/step - loss: 0.2661    131/Unknown - 21s 159ms/step - loss: 0.2646    132/Unknown - 22s 159ms/step - loss: 0.2634    133/Unknown - 22s 160ms/step - loss: 0.2621    134/Unknown - 22s 160ms/step - loss: 0.2609    135/Unknown - 22s 161ms/step - loss: 0.2597    136/Unknown - 22s 161ms/step - loss: 0.2584    137/Unknown - 23s 162ms/step - loss: 0.2570    138/Unknown - 23s 162ms/step - loss: 0.2557    139/Unknown - 23s 163ms/step - loss: 0.2544    140/Unknown - 23s 163ms/step - loss: 0.2532    141/Unknown - 24s 163ms/step - loss: 0.2520    142/Unknown - 24s 164ms/step - loss: 0.2508    143/Unknown - 24s 164ms/step - loss: 0.2496    144/Unknown - 24s 164ms/step - loss: 0.2484    145/Unknown - 24s 164ms/step - loss: 0.2473    146/Unknown - 25s 164ms/step - loss: 0.2461    147/Unknown - 25s 164ms/step - loss: 0.2451    148/Unknown - 25s 164ms/step - loss: 0.2439    149/Unknown - 25s 164ms/step - loss: 0.2430    150/Unknown - 25s 164ms/step - loss: 0.2419    151/Unknown - 25s 164ms/step - loss: 0.2410    152/Unknown - 26s 164ms/step - loss: 0.2401    153/Unknown - 26s 164ms/step - loss: 0.2392    154/Unknown - 26s 164ms/step - loss: 0.2384    155/Unknown - 26s 164ms/step - loss: 0.2373    156/Unknown - 26s 164ms/step - loss: 0.2364    157/Unknown - 26s 164ms/step - loss: 0.2355    158/Unknown - 27s 164ms/step - loss: 0.2346    159/Unknown - 27s 164ms/step - loss: 0.2338    160/Unknown - 27s 164ms/step - loss: 0.2329    161/Unknown - 27s 164ms/step - loss: 0.2321    162/Unknown - 27s 164ms/step - loss: 0.2312    163/Unknown - 27s 164ms/step - loss: 0.2303    164/Unknown - 28s 164ms/step - loss: 0.2294    165/Unknown - 28s 164ms/step - loss: 0.2286    166/Unknown - 28s 164ms/step - loss: 0.2278    167/Unknown - 28s 164ms/step - loss: 0.2270    168/Unknown - 28s 165ms/step - loss: 0.2262    169/Unknown - 28s 165ms/step - loss: 0.2253    170/Unknown - 29s 165ms/step - loss: 0.2244    171/Unknown - 29s 165ms/step - loss: 0.2236    172/Unknown - 29s 165ms/step - loss: 0.2228    173/Unknown - 29s 165ms/step - loss: 0.2220    174/Unknown - 29s 165ms/step - loss: 0.2212    175/Unknown - 29s 165ms/step - loss: 0.2203    176/Unknown - 30s 164ms/step - loss: 0.2196    177/Unknown - 30s 164ms/step - loss: 0.2189