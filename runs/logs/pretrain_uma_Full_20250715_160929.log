Forcing CPU for pretraining, unless APPLE fixes MPS support
================================================================================
ReconMAE Pretraining Script
================================================================================
Data path: ./data/ps2_p72/uma/snr10to25_speed5
Model: ReconMAE
Experiment: siso_1_umi_block_1_ps2_p72
Masking type: discrete
Epochs: 80
Learning rate: 0.001
Batch sizes: train=64, eval=64
================================================================================
Creating dataset with masking type: discrete
âœ… Dataset created successfully
âœ… Data loaders created: 507 train batches, 57 eval batches
âœ… Model hyperparameters loaded
âœ… Input shape determined: (2, 72, 2)
âœ… Model initialized successfully: ReconMAE
Model summary:
Model: "recon_mae"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 encoder (Encoder)           multiple                  125856    
                                                                 
 efficient_decoder (Efficie  multiple                  2186      
 ntDecoder)                                                      
                                                                 
 efficient_decoder_1 (Effic  multiple                  2754      
 ientDecoder)                                                    
                                                                 
=================================================================
Total params: 130796 (510.92 KB)
Trainable params: 130796 (510.92 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________
ðŸš€ Starting training for ReconMAE...
Initial validation loss: 1.7619
Epoch 1/80
      1/Unknown - 1s 951ms/step - loss: 1.7862      2/Unknown - 1s 78ms/step - loss: 1.8637       3/Unknown - 1s 78ms/step - loss: 1.7371      4/Unknown - 1s 77ms/step - loss: 1.6385      5/Unknown - 1s 77ms/step - loss: 1.5631      6/Unknown - 1s 76ms/step - loss: 1.4975      7/Unknown - 1s 76ms/step - loss: 1.4396      8/Unknown - 1s 76ms/step - loss: 1.3869      9/Unknown - 2s 76ms/step - loss: 1.3391     10/Unknown - 2s 77ms/step - loss: 1.2956     11/Unknown - 2s 77ms/step - loss: 1.2571     12/Unknown - 2s 77ms/step - loss: 1.2235     13/Unknown - 2s 77ms/step - loss: 1.1925     14/Unknown - 2s 77ms/step - loss: 1.1633     15/Unknown - 2s 77ms/step - loss: 1.1370     16/Unknown - 2s 77ms/step - loss: 1.1123     17/Unknown - 2s 77ms/step - loss: 1.0894     18/Unknown - 2s 77ms/step - loss: 1.0682     19/Unknown - 2s 77ms/step - loss: 1.0486     20/Unknown - 2s 77ms/step - loss: 1.0297     21/Unknown - 2s 77ms/step - loss: 1.0126     22/Unknown - 3s 77ms/step - loss: 0.9962     23/Unknown - 3s 77ms/step - loss: 0.9812     24/Unknown - 3s 77ms/step - loss: 0.9668     25/Unknown - 3s 77ms/step - loss: 0.9535     26/Unknown - 3s 78ms/step - loss: 0.9409     27/Unknown - 3s 78ms/step - loss: 0.9286     28/Unknown - 3s 78ms/step - loss: 0.9169     29/Unknown - 3s 78ms/step - loss: 0.9063     30/Unknown - 3s 78ms/step - loss: 0.8962     31/Unknown - 3s 78ms/step - loss: 0.8859     32/Unknown - 3s 78ms/step - loss: 0.8767     33/Unknown - 3s 78ms/step - loss: 0.8678     34/Unknown - 4s 78ms/step - loss: 0.8592     35/Unknown - 4s 78ms/step - loss: 0.8511     36/Unknown - 4s 78ms/step - loss: 0.8433     37/Unknown - 4s 78ms/step - loss: 0.8356     38/Unknown - 4s 79ms/step - loss: 0.8283     39/Unknown - 4s 79ms/step - loss: 0.8212     40/Unknown - 4s 79ms/step - loss: 0.8142     41/Unknown - 4s 79ms/step - loss: 0.8075     42/Unknown - 4s 79ms/step - loss: 0.8011     43/Unknown - 4s 79ms/step - loss: 0.7948     44/Unknown - 4s 79ms/step - loss: 0.7889     45/Unknown - 4s 79ms/step - loss: 0.7828     46/Unknown - 5s 79ms/step - loss: 0.7772     47/Unknown - 5s 79ms/step - loss: 0.7715     48/Unknown - 5s 80ms/step - loss: 0.7661     49/Unknown - 5s 80ms/step - loss: 0.7605     50/Unknown - 5s 80ms/step - loss: 0.7554     51/Unknown - 5s 80ms/step - loss: 0.7502     52/Unknown - 5s 80ms/step - loss: 0.7452     53/Unknown - 5s 80ms/step - loss: 0.7404     54/Unknown - 5s 80ms/step - loss: 0.7356     55/Unknown - 5s 81ms/step - loss: 0.7308     56/Unknown - 5s 81ms/step - loss: 0.7260     57/Unknown - 5s 81ms/step - loss: 0.7216     58/Unknown - 6s 81ms/step - loss: 0.7172     59/Unknown - 6s 81ms/step - loss: 0.7128     60/Unknown - 6s 81ms/step - loss: 0.7086     61/Unknown - 6s 81ms/step - loss: 0.7043     62/Unknown - 6s 81ms/step - loss: 0.7002     63/Unknown - 6s 81ms/step - loss: 0.6963     64/Unknown - 6s 81ms/step - loss: 0.6922     65/Unknown - 6s 81ms/step - loss: 0.6881     66/Unknown - 6s 81ms/step - loss: 0.6842     67/Unknown - 6s 81ms/step - loss: 0.6807     68/Unknown - 6s 81ms/step - loss: 0.6770     69/Unknown - 6s 81ms/step - loss: 0.6734     70/Unknown - 7s 81ms/step - loss: 0.6697     71/Unknown - 7s 82ms/step - loss: 0.6663     72/Unknown - 7s 82ms/step - loss: 0.6626     73/Unknown - 7s 82ms/step - loss: 0.6594     74/Unknown - 7s 82ms/step - loss: 0.6560     75/Unknown - 7s 82ms/step - loss: 0.6527     76/Unknown - 7s 82ms/step - loss: 0.6494     77/Unknown - 7s 82ms/step - loss: 0.6459     78/Unknown - 7s 82ms/step - loss: 0.6427     79/Unknown - 7s 82ms/step - loss: 0.6394     80/Unknown - 7s 82ms/step - loss: 0.6361     81/Unknown - 7s 82ms/step - loss: 0.6331     82/Unknown - 8s 82ms/step - loss: 0.6300     83/Unknown - 8s 82ms/step - loss: 0.6271     84/Unknown - 8s 82ms/step - loss: 0.6240     85/Unknown - 8s 82ms/step - loss: 0.6210     86/Unknown - 8s 82ms/step - loss: 0.6182     87/Unknown - 8s 82ms/step - loss: 0.6151     88/Unknown - 8s 82ms/step - loss: 0.6124     89/Unknown - 8s 82ms/step - loss: 0.6095     90/Unknown - 8s 82ms/step - loss: 0.6067     91/Unknown - 8s 82ms/step - loss: 0.6039     92/Unknown - 8s 82ms/step - loss: 0.6013     93/Unknown - 8s 82ms/step - loss: 0.5984     94/Unknown - 9s 82ms/step - loss: 0.5958     95/Unknown - 9s 82ms/step - loss: 0.5933     96/Unknown - 9s 82ms/step - loss: 0.5908     97/Unknown - 9s 82ms/step - loss: 0.5883     98/Unknown - 9s 82ms/step - loss: 0.5858     99/Unknown - 9s 82ms/step - loss: 0.5833    100/Unknown - 9s 82ms/step - loss: 0.5808    101/Unknown - 9s 82ms/step - loss: 0.5783    102/Unknown - 9s 82ms/step - loss: 0.5758    103/Unknown - 9s 82ms/step - loss: 0.5735    104/Unknown - 9s 82ms/step - loss: 0.5712    105/Unknown - 9s 82ms/step - loss: 0.5688    106/Unknown - 10s 82ms/step - loss: 0.5668    107/Unknown - 10s 82ms/step - loss: 0.5645    108/Unknown - 10s 82ms/step - loss: 0.5624    109/Unknown - 10s 82ms/step - loss: 0.5602    110/Unknown - 10s 82ms/step - loss: 0.5579    111/Unknown - 10s 82ms/step - loss: 0.5558    112/Unknown - 10s 82ms/step - loss: 0.5535    113/Unknown - 10s 82ms/step - loss: 0.5513    114/Unknown - 10s 82ms/step - loss: 0.5489    115/Unknown - 10s 82ms/step - loss: 0.5467    116/Unknown - 10s 82ms/step - loss: 0.5446    117/Unknown - 11s 82ms/step - loss: 0.5423    118/Unknown - 11s 83ms/step - loss: 0.5403    119/Unknown - 11s 83ms/step - loss: 0.5381    120/Unknown - 11s 83ms/step - loss: 0.5359    121/Unknown - 11s 84ms/step - loss: 0.5337    122/Unknown - 11s 83ms/step - loss: 0.5317    123/Unknown - 11s 83ms/step - loss: 0.5296    124/Unknown - 11s 83ms/step - loss: 0.5276    125/Unknown - 11s 84ms/step - loss: 0.5257    126/Unknown - 11s 84ms/step - loss: 0.5239    127/Unknown - 11s 84ms/step - loss: 0.5219    128/Unknown - 12s 84ms/step - loss: 0.5199    129/Unknown - 12s 84ms/step - loss: 0.5180    130/Unknown - 12s 84ms/step - loss: 0.5162    131/Unknown - 12s 84ms/step - loss: 0.5143    132/Unknown - 12s 84ms/step - loss: 0.5125    133/Unknown - 12s 84ms/step - loss: 0.5106    134/Unknown - 12s 84ms/step - loss: 0.5086    135/Unknown - 12s 84ms/step - loss: 0.5069    136/Unknown - 12s 84ms/step - loss: 0.5050    137/Unknown - 12s 84ms/step - loss: 0.5031    138/Unknown - 12s 84ms/step - loss: 0.5012    139/Unknown - 13s 84ms/step - loss: 0.4993    140/Unknown - 13s 84ms/step - loss: 0.4975    141/Unknown - 13s 84ms/step - loss: 0.4957    142/Unknown - 13s 84ms/step - loss: 0.4939    143/Unknown - 13s 84ms/step - loss: 0.4922    144/Unknown - 13s 84ms/step - loss: 0.4904    145/Unknown - 13s 84ms/step - loss: 0.4887    146/Unknown - 13s 84ms/step - loss: 0.4870    147/Unknown - 13s 84ms/step - loss: 0.4853    148/Unknown - 13s 84ms/step - loss: 0.4837    149/Unknown - 13s 84ms/step - loss: 0.4820    150/Unknown - 14s 84ms/step - loss: 0.4803    151/Unknown - 14s 85ms/step - loss: 0.4786    152/Unknown - 14s 85ms/step - loss: 0.4769    153/Unknown - 14s 85ms/step - loss: 0.4754    154/Unknown - 14s 84ms/step - loss: 0.4737    155/Unknown - 14s 85ms/step - loss: 0.4721    156/Unknown - 14s 85ms/step - loss: 0.4705    157/Unknown - 14s 85ms/step - loss: 0.4689    158/Unknown - 14s 85ms/step - loss: 0.4674    159/Unknown - 14s 85ms/step - loss: 0.4659    160/Unknown - 14s 85ms/step - loss: 0.4644    161/Unknown - 14s 85ms/step - loss: 0.4629    162/Unknown - 15s 85ms/step - loss: 0.4613    163/Unknown - 15s 85ms/step - loss: 0.4597    164/Unknown - 15s 85ms/step - loss: 0.4582    165/Unknown - 15s 85ms/step - loss: 0.4567    166/Unknown - 15s 85ms/step - loss: 0.4551    167/Unknown - 15s 85ms/step - loss: 0.4536    168/Unknown - 15s 85ms/step - loss: 0.4521    169/Unknown - 15s 85ms/step - loss: 0.4506    170/Unknown - 15s 85ms/step - loss: 0.4491    171/Unknown - 15s 85ms/step - loss: 0.4477    172/Unknown - 15s 85ms/step - loss: 0.4463    173/Unknown - 15s 84ms/step - loss: 0.4449    174/Unknown - 16s 84ms/step - loss: 0.4434    175/Unknown - 16s 84ms/step - loss: 0.4420    176/Unknown - 16s 85ms/step - loss: 0.4406    177/Unknown - 16s 85ms/step - loss: 0.4391    178/Unknown - 16s 85ms/step - loss: 0.4377    179/Unknown - 16s 85ms/step - loss: 0.4363    180/Unknown - 16s 85ms/step - loss: 0.4350    181/Unknown - 16s 85ms/step - loss: 0.4336    182/Unknown - 16s 85ms/step - loss: 0.4322    183/Unknown - 16s 85ms/step - loss: 0.4308    184/Unknown - 16s 85ms/step - loss: 0.4295    185/Unknown - 17s 85ms/step - loss: 0.4281    186/Unknown - 17s 85ms/step - loss: 0.4268    187/Unknown - 17s 85ms/step - loss: 0.4255    188/Unknown - 17s 85ms/step - loss: 0.4241    189/Unknown - 17s 85ms/step - loss: 0.4228    190/Unknown - 17s 85ms/step - loss: 0.4215    191/Unknown - 17s 85ms/step - loss: 0.4203    192/Unknown - 17s 85ms/step - loss: 0.4190    193/Unknown - 17s 85ms/step - loss: 0.4177    194/Unknown - 17s 85ms/step - loss: 0.4164    195/Unknown - 18s 85ms/step - loss: 0.4152    196/Unknown - 18s 85ms/step - loss: 0.4139    197/Unknown - 18s 85ms/step - loss: 0.4126    198/Unknown - 18s 85ms/step - loss: 0.4113    199/Unknown - 18s 86ms/step - loss: 0.4101    200/Unknown - 18s 86ms/step - loss: 0.4089    201/Unknown - 18s 86ms/step - loss: 0.4077    202/Unknown - 18s 86ms/step - loss: 0.4064    203/Unknown - 18s 86ms/step - loss: 0.4053    204/Unknown - 18s 86ms/step - loss: 0.4041    205/Unknown - 18s 86ms/step - loss: 0.4030    206/Unknown - 19s 86ms/step - loss: 0.4017    207/Unknown - 19s 86ms/step - loss: 0.4006    208/Unknown - 19s 86ms/step - loss: 0.3994    209/Unknown - 19s 86ms/step - loss: 0.3983    210/Unknown - 19s 86ms/step - loss: 0.3971    211/Unknown - 19s 86ms/step - loss: 0.3960    212/Unknown - 19s 86ms/step - loss: 0.3949    213/Unknown - 19s 86ms/step - loss: 0.3938    214/Unknown - 19s 86ms/step - loss: 0.3927    215/Unknown - 19s 86ms/step - loss: 0.3916    216/Unknown - 19s 86ms/step - loss: 0.3905    217/Unknown - 19s 86ms/step - loss: 0.3895    218/Unknown - 20s 86ms/step - loss: 0.3884    219/Unknown - 20s 86ms/step - loss: 0.3873    220/Unknown - 20s 86ms/step - loss: 0.3862    221/Unknown - 20s 86ms/step - loss: 0.3852    222/Unknown - 20s 86ms/step - loss: 0.3841    223/Unknown - 20s 86ms/step - loss: 0.3831    224/Unknown - 20s 86ms/step - loss: 0.3821    225/Unknown - 20s 86ms/step - loss: 0.3810    226/Unknown - 20s 86ms/step - loss: 0.3800    227/Unknown - 20s 86ms/step - loss: 0.3789    228/Unknown - 20s 86ms/step - loss: 0.3779    229/Unknown - 20s 86ms/step - loss: 0.3769    230/Unknown - 21s 86ms/step - loss: 0.3759    231/Unknown - 21s 86ms/step - loss: 0.3749    232/Unknown - 21s 86ms/step - loss: 0.3739    233/Unknown - 21s 86ms/step - loss: 0.3729    234/Unknown - 21s 86ms/step - loss: 0.3720    235/Unknown - 21s 86ms/step - loss: 0.3710    236/Unknown - 21s 86ms/step - loss: 0.3701    237/Unknown - 21s 86ms/step - loss: 0.3691    238/Unknown - 21s 86ms/step - loss: 0.3681    239/Unknown - 21s 85ms/step - loss: 0.3672    240/Unknown - 21s 85ms/step - loss: 0.3662    241/Unknown - 21s 85ms/step - loss: 0.3653    242/Unknown - 22s 86ms/step - loss: 0.3644    243/Unknown - 22s 86ms/step - loss: 0.3635    244/Unknown - 22s 86ms/step - loss: 0.3626    245/Unknown - 22s 86ms/step - loss: 0.3617    246/Unknown - 22s 86ms/step - loss: 0.3609    247/Unknown - 22s 86ms/step - loss: 0.3599    248/Unknown - 22s 86ms/step - loss: 0.3591    249/Unknown - 22s 86ms/step - loss: 0.3582    250/Unknown - 22s 86ms/step - loss: 0.3573    251/Unknown - 22s 86ms/step - loss: 0.3564    252/Unknown - 23s 86ms/step - loss: 0.3556    253/Unknown - 23s 86ms/step - loss: 0.3547    254/Unknown - 23s 86ms/step - loss: 0.3538    255/Unknown - 23s 86ms/step - loss: 0.3530    256/Unknown - 23s 86ms/step - loss: 0.3522    257/Unknown - 23s 86ms/step - loss: 0.3513    258/Unknown - 23s 86ms/step - loss: 0.3505    259/Unknown - 23s 86ms/step - loss: 0.3496    260/Unknown - 23s 86ms/step - loss: 0.3488    261/Unknown - 23s 86ms/step - loss: 0.3480    262/Unknown - 23s 86ms/step - loss: 0.3471    263/Unknown - 23s 86ms/step - loss: 0.3463    264/Unknown - 24s 86ms/step - loss: 0.3455    265/Unknown - 24s 86ms/step - loss: 0.3447    266/Unknown - 24s 86ms/step - loss: 0.3439    267/Unknown - 24s 86ms/step - loss: 0.3431    268/Unknown - 24s 86ms/step - loss: 0.3423    269/Unknown - 24s 86ms/step - loss: 0.3415    270/Unknown - 24s 86ms/step - loss: 0.3407    271/Unknown - 24s 86ms/step - loss: 0.3399    272/Unknown - 24s 86ms/step - loss: 0.3391    273/Unknown - 24s 86ms/step - loss: 0.3383    274/Unknown - 24s 86ms/step - loss: 0.3376    275/Unknown - 25s 86ms/step - loss: 0.3368    276/Unknown - 25s 86ms/step - loss: 0.3361    277/Unknown - 25s 86ms/step - loss: 0.3353    278/Unknown - 25s 87ms/step - loss: 0.3345    279/Unknown - 25s 87ms/step - loss: 0.3338    280/Unknown - 25s 87ms/step - loss: 0.3330    281/Unknown - 25s 87ms/step - loss: 0.3323    282/Unknown - 25s 87ms/step - loss: 0.3315    283/Unknown - 25s 87ms/step - loss: 0.3308    284/Unknown - 26s 87ms/step - loss: 0.3301    285/Unknown - 26s 87ms/step - loss: 0.3294    286/Unknown - 26s 87ms/step - loss: 0.3287    287/Unknown - 26s 87ms/step - loss: 0.3280    288/Unknown - 26s 87ms/step - loss: 0.3273    289/Unknown - 26s 87ms/step - loss: 0.3266    290/Unknown - 26s 87ms/step - loss: 0.3258    291/Unknown - 26s 87ms/step - loss: 0.3252    292/Unknown - 26s 87ms/step - loss: 0.3245    293/Unknown - 26s 87ms/step - loss: 0.3238    294/Unknown - 26s 87ms/step - loss: 0.3231    295/Unknown - 27s 87ms/step - loss: 0.3224    296/Unknown - 27s 87ms/step - loss: 0.3217    297/Unknown - 27s 87ms/step - loss: 0.3210    298/Unknown - 27s 87ms/step - loss: 0.3204    299/Unknown - 27s 87ms/step - loss: 0.3197    300/Unknown - 27s 87ms/step - loss: 0.3190    301/Unknown - 27s 87ms/step - loss: 0.3183    302/Unknown - 27s 87ms/step - loss: 0.3176    303/Unknown - 27s 87ms/step - loss: 0.3170    304/Unknown - 27s 87ms/step - loss: 0.3163    305/Unknown - 28s 87ms/step - loss: 0.3157    306/Unknown - 28s 87ms/step - loss: 0.3150    307/Unknown - 28s 87ms/step - loss: 0.3143    308/Unknown - 28s 87ms/step - loss: 0.3137    309/Unknown - 28s 87ms/step - loss: 0.3130    310/Unknown - 28s 87ms/step - loss: 0.3124    311/Unknown - 28s 87ms/step - loss: 0.3118    312/Unknown - 28s 87ms/step - loss: 0.3111    313/Unknown - 28s 87ms/step - loss: 0.3105