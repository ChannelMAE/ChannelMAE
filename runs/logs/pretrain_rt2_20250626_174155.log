✅ GPU acceleration enabled (MPS)
================================================================================
ReconMAE Pretraining Script
================================================================================
Data path: ./data/ps2_p72/rt2/snr10to25_speed5
Model: ReconMAE
Experiment: siso_1_umi_block_1_ps2_p72
Masking type: discrete
Epochs: 80
Learning rate: 0.001
Batch sizes: train=64, eval=64
================================================================================
Creating dataset with masking type: discrete
tf.Tensor([ 1  1  2 72  2], shape=(5,), dtype=int32)
tf.Tensor([ 1  1  2 72  2], shape=(5,), dtype=int32)
✅ Dataset created successfully
✅ Data loaders created: 507 train batches, 57 eval batches
✅ Model hyperparameters loaded
✅ Input shape determined: (2, 72, 2)
✅ Model initialized successfully
Model summary:
Model: "recon_mae"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ encoder (Encoder)               │ ?                      │       125,856 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ decoder (Decoder)               │ ?                      │        27,346 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ decoder_1 (Decoder)             │ ?                      │        53,074 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 206,276 (805.77 KB)
 Trainable params: 206,276 (805.77 KB)
 Non-trainable params: 0 (0.00 B)
Traceback (most recent call last):
  File "/Users/yuanzhehuang/Desktop/TTT_for_wireless/cebed/pretrain_recon_mae.py", line 191, in main
    history, log_dir = model.train_model(
                       ^^^^^^^^^^^^^^^^^^
  File "/Users/yuanzhehuang/Desktop/TTT_for_wireless/cebed/models_with_ssl/recon_net.py", line 567, in train_model
    callbacks = self.get_training_callbacks(log_dir, verbose)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yuanzhehuang/Desktop/TTT_for_wireless/cebed/models_with_ssl/recon_net.py", line 518, in get_training_callbacks
    checkpoint_callback = tf.keras.callbacks.ModelCheckpoint(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/mps_sionna/lib/python3.11/site-packages/keras/src/callbacks/model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=./model_output/ReconMAE_20250626_174207/cp.ckpt
🚀 Starting training...
❌ Error during training: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=./model_output/ReconMAE_20250626_174207/cp.ckpt
