GPU devices found:
  PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')
✅ GPU acceleration enabled (MPS)
================================================================================
ReconMAE Pretraining Script
================================================================================
Data path: ./data/ps2_p72/rt0/snr10to25_speed5
Model: ReconMAE
Experiment: siso_1_umi_block_1_ps2_p72
Masking type: discrete
Epochs: 1
Learning rate: 0.001
Batch sizes: train=64, eval=64
================================================================================
Creating dataset with masking type: discrete
✅ Dataset created successfully
✅ Data loaders created: 507 train batches, 57 eval batches
✅ Model hyperparameters loaded
✅ Input shape determined: (2, 72, 2)
✅ Model initialized successfully
Model summary:
Model: "recon_mae"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 encoder (Encoder)           multiple                  125856    
                                                                 
 decoder (Decoder)           multiple                  27346     
                                                                 
 decoder_1 (Decoder)         multiple                  53074     
                                                                 
=================================================================
Total params: 206276 (805.77 KB)
Trainable params: 206276 (805.77 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________
🚀 Starting training...
Initial validation loss: 1.9274
      1/Unknown - 1s 1s/step - loss: 1.9350      2/Unknown - 1s 67ms/step - loss: 1.7532      4/Unknown - 2s 53ms/step - loss: 1.3639      6/Unknown - 2s 49ms/step - loss: 1.1438      8/Unknown - 2s 47ms/step - loss: 1.0090     10/Unknown - 2s 45ms/step - loss: 0.9192     12/Unknown - 2s 45ms/step - loss: 0.8586     14/Unknown - 2s 44ms/step - loss: 0.8122     16/Unknown - 2s 44ms/step - loss: 0.7769     18/Unknown - 2s 43ms/step - loss: 0.7488     20/Unknown - 2s 43ms/step - loss: 0.7268     22/Unknown - 2s 43ms/step - loss: 0.7061     24/Unknown - 2s 43ms/step - loss: 0.6903     26/Unknown - 2s 44ms/step - loss: 0.6759     28/Unknown - 3s 43ms/step - loss: 0.6632     30/Unknown - 3s 43ms/step - loss: 0.6504     32/Unknown - 3s 43ms/step - loss: 0.6401     34/Unknown - 3s 43ms/step - loss: 0.6319     36/Unknown - 3s 43ms/step - loss: 0.6226     38/Unknown - 3s 43ms/step - loss: 0.6145     40/Unknown - 3s 43ms/step - loss: 0.6056     42/Unknown - 3s 43ms/step - loss: 0.5976     44/Unknown - 3s 43ms/step - loss: 0.5889     46/Unknown - 3s 43ms/step - loss: 0.5804     48/Unknown - 3s 42ms/step - loss: 0.5718     50/Unknown - 3s 42ms/step - loss: 0.5633     52/Unknown - 4s 42ms/step - loss: 0.5546     54/Unknown - 4s 42ms/step - loss: 0.5464     56/Unknown - 4s 42ms/step - loss: 0.5380     58/Unknown - 4s 42ms/step - loss: 0.5299     60/Unknown - 4s 42ms/step - loss: 0.5216     62/Unknown - 4s 42ms/step - loss: 0.5137     64/Unknown - 4s 42ms/step - loss: 0.5056     66/Unknown - 4s 42ms/step - loss: 0.4972     68/Unknown - 4s 42ms/step - loss: 0.4892     70/Unknown - 4s 42ms/step - loss: 0.4812     72/Unknown - 4s 42ms/step - loss: 0.4733     74/Unknown - 4s 42ms/step - loss: 0.4655     76/Unknown - 5s 42ms/step - loss: 0.4581     78/Unknown - 5s 42ms/step - loss: 0.4507     80/Unknown - 5s 42ms/step - loss: 0.4443     82/Unknown - 5s 42ms/step - loss: 0.4382     84/Unknown - 5s 42ms/step - loss: 0.4320     86/Unknown - 5s 42ms/step - loss: 0.4260     88/Unknown - 5s 42ms/step - loss: 0.4200     90/Unknown - 5s 42ms/step - loss: 0.4143     92/Unknown - 5s 42ms/step - loss: 0.4091     94/Unknown - 5s 42ms/step - loss: 0.4037     96/Unknown - 5s 42ms/step - loss: 0.3985     98/Unknown - 5s 42ms/step - loss: 0.3936    100/Unknown - 5s 42ms/step - loss: 0.3888    102/Unknown - 6s 42ms/step - loss: 0.3842    104/Unknown - 6s 42ms/step - loss: 0.3799    106/Unknown - 6s 42ms/step - loss: 0.3757    108/Unknown - 6s 42ms/step - loss: 0.3717    110/Unknown - 6s 42ms/step - loss: 0.3674    112/Unknown - 6s 42ms/step - loss: 0.3634    114/Unknown - 6s 42ms/step - loss: 0.3596    116/Unknown - 6s 42ms/step - loss: 0.3560    118/Unknown - 6s 42ms/step - loss: 0.3526    120/Unknown - 6s 42ms/step - loss: 0.3491    122/Unknown - 6s 42ms/step - loss: 0.3457    124/Unknown - 6s 41ms/step - loss: 0.3422    126/Unknown - 7s 41ms/step - loss: 0.3390    128/Unknown - 7s 41ms/step - loss: 0.3360    130/Unknown - 7s 41ms/step - loss: 0.3329    132/Unknown - 7s 41ms/step - loss: 0.3295    134/Unknown - 7s 41ms/step - loss: 0.3263    136/Unknown - 7s 41ms/step - loss: 0.3231    138/Unknown - 7s 41ms/step - loss: 0.3198    140/Unknown - 7s 41ms/step - loss: 0.3166    142/Unknown - 7s 41ms/step - loss: 0.3136    144/Unknown - 7s 41ms/step - loss: 0.3104    146/Unknown - 7s 41ms/step - loss: 0.3072    148/Unknown - 7s 41ms/step - loss: 0.3041    150/Unknown - 8s 41ms/step - loss: 0.3009    152/Unknown - 8s 41ms/step - loss: 0.2979    154/Unknown - 8s 41ms/step - loss: 0.2948    156/Unknown - 8s 41ms/step - loss: 0.2919    158/Unknown - 8s 41ms/step - loss: 0.2890    160/Unknown - 8s 41ms/step - loss: 0.2861    162/Unknown - 8s 41ms/step - loss: 0.2833    164/Unknown - 8s 41ms/step - loss: 0.2805    166/Unknown - 8s 41ms/step - loss: 0.2777    168/Unknown - 8s 41ms/step - loss: 0.2749    170/Unknown - 8s 41ms/step - loss: 0.2722    172/Unknown - 8s 41ms/step - loss: 0.2696    174/Unknown - 9s 41ms/step - loss: 0.2670    175/Unknown - 9s 41ms/step - loss: 0.2657    177/Unknown - 9s 41ms/step - loss: 0.2631    179/Unknown - 9s 41ms/step - loss: 0.2607    181/Unknown - 9s 41ms/step - loss: 0.2582    183/Unknown - 9s 41ms/step - loss: 0.2558    185/Unknown - 9s 41ms/step - loss: 0.2534    187/Unknown - 9s 41ms/step - loss: 0.2511    189/Unknown - 9s 41ms/step - loss: 0.2488    191/Unknown - 9s 41ms/step - loss: 0.2466    193/Unknown - 9s 41ms/step - loss: 0.2444    195/Unknown - 9s 41ms/step - loss: 0.2423    197/Unknown - 9s 41ms/step - loss: 0.2402    199/Unknown - 10s 41ms/step - loss: 0.2381    201/Unknown - 10s 41ms/step - loss: 0.2360    203/Unknown - 10s 41ms/step - loss: 0.2340    205/Unknown - 10s 41ms/step - loss: 0.2321    207/Unknown - 10s 41ms/step - loss: 0.2301    209/Unknown - 10s 41ms/step - loss: 0.2282    211/Unknown - 10s 41ms/step - loss: 0.2263    213/Unknown - 10s 41ms/step - loss: 0.2245    215/Unknown - 10s 41ms/step - loss: 0.2227    217/Unknown - 10s 41ms/step - loss: 0.2209    219/Unknown - 10s 41ms/step - loss: 0.2191    221/Unknown - 10s 41ms/step - loss: 0.2174    223/Unknown - 11s 41ms/step - loss: 0.2157    225/Unknown - 11s 41ms/step - loss: 0.2141    227/Unknown - 11s 41ms/step - loss: 0.2124    229/Unknown - 11s 41ms/step - loss: 0.2108    231/Unknown - 11s 41ms/step - loss: 0.2092    233/Unknown - 11s 41ms/step - loss: 0.2077    235/Unknown - 11s 41ms/step - loss: 0.2062    237/Unknown - 11s 41ms/step - loss: 0.2047    239/Unknown - 11s 41ms/step - loss: 0.2032    241/Unknown - 11s 41ms/step - loss: 0.2017    243/Unknown - 11s 41ms/step - loss: 0.2003    245/Unknown - 11s 41ms/step - loss: 0.1989    247/Unknown - 12s 41ms/step - loss: 0.1975    249/Unknown - 12s 41ms/step - loss: 0.1961    251/Unknown - 12s 41ms/step - loss: 0.1948    253/Unknown - 12s 41ms/step - loss: 0.1934    255/Unknown - 12s 41ms/step - loss: 0.1921    257/Unknown - 12s 41ms/step - loss: 0.1908    259/Unknown - 12s 41ms/step - loss: 0.1896    261/Unknown - 12s 41ms/step - loss: 0.1883    263/Unknown - 12s 41ms/step - loss: 0.1870    265/Unknown - 12s 41ms/step - loss: 0.1858    267/Unknown - 12s 41ms/step - loss: 0.1846    269/Unknown - 12s 41ms/step - loss: 0.1834    271/Unknown - 13s 41ms/step - loss: 0.1823    273/Unknown - 13s 41ms/step - loss: 0.1811    275/Unknown - 13s 41ms/step - loss: 0.1800    277/Unknown - 13s 41ms/step - loss: 0.1788    279/Unknown - 13s 41ms/step - loss: 0.1777    281/Unknown - 13s 41ms/step - loss: 0.1766    283/Unknown - 13s 41ms/step - loss: 0.1755    285/Unknown - 13s 41ms/step - loss: 0.1745    287/Unknown - 13s 41ms/step - loss: 0.1734    289/Unknown - 13s 41ms/step - loss: 0.1724    291/Unknown - 13s 41ms/step - loss: 0.1714    293/Unknown - 13s 41ms/step - loss: 0.1703    295/Unknown - 14s 41ms/step - loss: 0.1693    297/Unknown - 14s 41ms/step - loss: 0.1684    299/Unknown - 14s 41ms/step - loss: 0.1674    301/Unknown - 14s 41ms/step - loss: 0.1664    303/Unknown - 14s 41ms/step - loss: 0.1655    305/Unknown - 14s 41ms/step - loss: 0.1645    307/Unknown - 14s 41ms/step - loss: 0.1636    309/Unknown - 14s 41ms/step - loss: 0.1627    311/Unknown - 14s 41ms/step - loss: 0.1618    313/Unknown - 14s 41ms/step - loss: 0.1609    315/Unknown - 14s 41ms/step - loss: 0.1600    317/Unknown - 14s 41ms/step - loss: 0.1592    319/Unknown - 15s 41ms/step - loss: 0.1583    321/Unknown - 15s 41ms/step - loss: 0.1575    323/Unknown - 15s 41ms/step - loss: 0.1566    325/Unknown - 15s 41ms/step - loss: 0.1558    327/Unknown - 15s 41ms/step - loss: 0.1550    329/Unknown - 15s 41ms/step - loss: 0.1542    331/Unknown - 15s 41ms/step - loss: 0.1534    333/Unknown - 15s 41ms/step - loss: 0.1526    335/Unknown - 15s 41ms/step - loss: 0.1518    337/Unknown - 15s 41ms/step - loss: 0.1510    339/Unknown - 15s 41ms/step - loss: 0.1503    341/Unknown - 15s 41ms/step - loss: 0.1495    343/Unknown - 15s 41ms/step - loss: 0.1488    345/Unknown - 16s 41ms/step - loss: 0.1480    347/Unknown - 16s 41ms/step - loss: 0.1473    349/Unknown - 16s 41ms/step - loss: 0.1466    351/Unknown - 16s 41ms/step - loss: 0.1459    353/Unknown - 16s 41ms/step - loss: 0.1452    355/Unknown - 16s 41ms/step - loss: 0.1445    357/Unknown - 16s 41ms/step - loss: 0.1438    359/Unknown - 16s 41ms/step - loss: 0.1431    361/Unknown - 16s 41ms/step - loss: 0.1424    363/Unknown - 16s 41ms/step - loss: 0.1418    365/Unknown - 16s 41ms/step - loss: 0.1411    367/Unknown - 16s 41ms/step - loss: 0.1405    369/Unknown - 17s 41ms/step - loss: 0.1398    371/Unknown - 17s 41ms/step - loss: 0.1392    373/Unknown - 17s 41ms/step - loss: 0.1385    375/Unknown - 17s 41ms/step - loss: 0.1379    377/Unknown - 17s 41ms/step - loss: 0.1373    379/Unknown - 17s 41ms/step - loss: 0.1367    381/Unknown - 17s 41ms/step - loss: 0.1360    383/Unknown - 17s 41ms/step - loss: 0.1354    385/Unknown - 17s 41ms/step - loss: 0.1349    387/Unknown - 17s 41ms/step - loss: 0.1343    389/Unknown - 17s 41ms/step - loss: 0.1337    391/Unknown - 17s 41ms/step - loss: 0.1331    393/Unknown - 18s 41ms/step - loss: 0.1325    395/Unknown - 18s 41ms/step - loss: 0.1320    397/Unknown - 18s 41ms/step - loss: 0.1314    399/Unknown - 18s 41ms/step - loss: 0.1308    401/Unknown - 18s 41ms/step - loss: 0.1303    403/Unknown - 18s 41ms/step - loss: 0.1297    405/Unknown - 18s 41ms/step - loss: 0.1292    407/Unknown - 18s 41ms/step - loss: 0.1286    409/Unknown - 18s 41ms/step - loss: 0.1281    411/Unknown - 18s 41ms/step - loss: 0.1276    413/Unknown - 18s 41ms/step - loss: 0.1271    415/Unknown - 18s 41ms/step - loss: 0.1265    417/Unknown - 19s 41ms/step - loss: 0.1260    419/Unknown - 19s 41ms/step - loss: 0.1255    421/Unknown - 19s 41ms/step - loss: 0.1250    423/Unknown - 19s 41ms/step - loss: 0.1245    425/Unknown - 19s 41ms/step - loss: 0.1240    427/Unknown - 19s 41ms/step - loss: 0.1235    429/Unknown - 19s 41ms/step - loss: 0.1231    431/Unknown - 19s 41ms/step - loss: 0.1226    433/Unknown - 19s 41ms/step - loss: 0.1221    435/Unknown - 19s 41ms/step - loss: 0.1216    437/Unknown - 19s 41ms/step - loss: 0.1212    439/Unknown - 19s 41ms/step - loss: 0.1207    441/Unknown - 20s 41ms/step - loss: 0.1202    443/Unknown - 20s 41ms/step - loss: 0.1198    445/Unknown - 20s 41ms/step - loss: 0.1193    447/Unknown - 20s 41ms/step - loss: 0.1189    449/Unknown - 20s 41ms/step - loss: 0.1184    451/Unknown - 20s 41ms/step - loss: 0.1180    453/Unknown - 20s 41ms/step - loss: 0.1176    455/Unknown - 20s 41ms/step - loss: 0.1171    457/Unknown - 20s 41ms/step - loss: 0.1167    459/Unknown - 20s 41ms/step - loss: 0.1163    461/Unknown - 20s 41ms/step - loss: 0.1159    463/Unknown - 20s 41ms/step - loss: 0.1154    464/Unknown - 20s 41ms/step - loss: 0.1152    466/Unknown - 21s 41ms/step - loss: 0.1148    468/Unknown - 21s 41ms/step - loss: 0.1144    470/Unknown - 21s 41ms/step - loss: 0.1140    472/Unknown - 21s 41ms/step - loss: 0.1136    474/Unknown - 21s 41ms/step - loss: 0.1132    476/Unknown - 21s 41ms/step - loss: 0.1128    478/Unknown - 21s 41ms/step - loss: 0.1124    480/Unknown - 21s 41ms/step - loss: 0.1120    482/Unknown - 21s 41ms/step - loss: 0.1116    484/Unknown - 21s 41ms/step - loss: 0.1112    486/Unknown - 21s 41ms/step - loss: 0.1109    488/Unknown - 21s 41ms/step - loss: 0.1105    490/Unknown - 22s 41ms/step - loss: 0.1101    492/Unknown - 22s 41ms/step - loss: 0.1097    494/Unknown - 22s 41ms/step - loss: 0.1093    496/Unknown - 22s 41ms/step - loss: 0.1090    498/Unknown - 22s 41ms/step - loss: 0.1086    500/Unknown - 22s 41ms/step - loss: 0.1082    502/Unknown - 22s 41ms/step - loss: 0.1079    504/Unknown - 22s 41ms/step - loss: 0.1075    506/Unknown - 22s 41ms/step - loss: 0.1071    507/Unknown - 23s 42ms/step - loss: 0.1071
Epoch 1: val_loss improved from inf to 0.01832, saving model to ./model_output/ReconMAE_20250628_111443/cp.ckpt
507/507 [==============================] - 24s 45ms/step - loss: 0.1071 - val_loss: 0.0183 - lr: 0.0010
Loaded best weights from checkpoint before saving .h5 file
Converting weights to CPU format for cross-platform compatibility...
✅ CPU-compatible weights saved to:
   ./model_output/ReconMAE_20250628_111443/rt0.h5
   ./model_output/ReconMAE_20250628_111443/rt0_cpu.h5
✅ Training completed successfully!
📁 Model saved in: ./model_output/ReconMAE_20250628_111443
💾 Weights file: rt0.h5
📊 Final training loss: 0.10710542649030685
📊 Final validation loss: 0.018321586772799492
