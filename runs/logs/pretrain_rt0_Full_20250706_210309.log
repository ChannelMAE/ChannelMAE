Forcing CPU for pretraining, unless APPLE fixes MPS support
================================================================================
ReconMAE Pretraining Script
================================================================================
Data path: ./data/ps2_p72/rt0/snr10to25_speed5
Model: ReconMAE
Experiment: siso_1_umi_block_1_ps2_p72
Masking type: discrete
Epochs: 80
Learning rate: 0.001
Batch sizes: train=64, eval=64
================================================================================
Creating dataset with masking type: discrete
âœ… Dataset created successfully
âœ… Data loaders created: 507 train batches, 57 eval batches
âœ… Model hyperparameters loaded
âœ… Input shape determined: (2, 72, 2)
âœ… Model initialized successfully: ReconMAE
Model summary:
Model: "recon_mae"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 encoder (Encoder)           multiple                  125856    
                                                                 
 decoder (Decoder)           multiple                  27346     
                                                                 
 decoder_1 (Decoder)         multiple                  53074     
                                                                 
=================================================================
Total params: 206276 (805.77 KB)
Trainable params: 206276 (805.77 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________
ðŸš€ Starting training for ReconMAE...
Initial validation loss: 1.8905
Epoch 1/80
      1/Unknown - 1s 1s/step - loss: 1.8350      2/Unknown - 1s 232ms/step - loss: 1.5756      3/Unknown - 2s 229ms/step - loss: 1.3923      4/Unknown - 2s 224ms/step - loss: 1.2478      5/Unknown - 2s 224ms/step - loss: 1.1430      6/Unknown - 2s 223ms/step - loss: 1.0685      7/Unknown - 2s 223ms/step - loss: 1.0051      8/Unknown - 3s 229ms/step - loss: 0.9560      9/Unknown - 3s 234ms/step - loss: 0.9145     10/Unknown - 3s 238ms/step - loss: 0.8845     11/Unknown - 3s 239ms/step - loss: 0.8558     12/Unknown - 4s 246ms/step - loss: 0.8305     13/Unknown - 4s 248ms/step - loss: 0.8076     14/Unknown - 4s 254ms/step - loss: 0.7924     15/Unknown - 5s 257ms/step - loss: 0.7775     16/Unknown - 5s 257ms/step - loss: 0.7622     17/Unknown - 5s 259ms/step - loss: 0.7486     18/Unknown - 5s 258ms/step - loss: 0.7355     19/Unknown - 6s 256ms/step - loss: 0.7256     20/Unknown - 6s 255ms/step - loss: 0.7151     21/Unknown - 6s 254ms/step - loss: 0.7061     22/Unknown - 6s 252ms/step - loss: 0.6968     23/Unknown - 7s 250ms/step - loss: 0.6877     24/Unknown - 7s 250ms/step - loss: 0.6799     25/Unknown - 7s 248ms/step - loss: 0.6727     26/Unknown - 7s 247ms/step - loss: 0.6666     27/Unknown - 7s 246ms/step - loss: 0.6600     28/Unknown - 8s 247ms/step - loss: 0.6533     29/Unknown - 8s 250ms/step - loss: 0.6467     30/Unknown - 8s 251ms/step - loss: 0.6405     31/Unknown - 9s 251ms/step - loss: 0.6344     32/Unknown - 9s 249ms/step - loss: 0.6286     33/Unknown - 9s 250ms/step - loss: 0.6229     34/Unknown - 9s 249ms/step - loss: 0.6172     35/Unknown - 10s 249ms/step - loss: 0.6117     36/Unknown - 10s 248ms/step - loss: 0.6060     37/Unknown - 10s 247ms/step - loss: 0.6009     38/Unknown - 10s 247ms/step - loss: 0.5961     39/Unknown - 10s 247ms/step - loss: 0.5911     40/Unknown - 11s 247ms/step - loss: 0.5874     41/Unknown - 11s 245ms/step - loss: 0.5825     42/Unknown - 11s 245ms/step - loss: 0.5783     43/Unknown - 11s 244ms/step - loss: 0.5739     44/Unknown - 12s 243ms/step - loss: 0.5700     45/Unknown - 12s 243ms/step - loss: 0.5665     46/Unknown - 12s 243ms/step - loss: 0.5626     47/Unknown - 12s 242ms/step - loss: 0.5588     48/Unknown - 12s 241ms/step - loss: 0.5553     49/Unknown - 13s 241ms/step - loss: 0.5517     50/Unknown - 13s 241ms/step - loss: 0.5484     51/Unknown - 13s 241ms/step - loss: 0.5451     52/Unknown - 13s 241ms/step - loss: 0.5417     53/Unknown - 14s 241ms/step - loss: 0.5382     54/Unknown - 14s 240ms/step - loss: 0.5352     55/Unknown - 14s 240ms/step - loss: 0.5319     56/Unknown - 14s 240ms/step - loss: 0.5283     57/Unknown - 14s 239ms/step - loss: 0.5247     58/Unknown - 15s 239ms/step - loss: 0.5220     59/Unknown - 15s 239ms/step - loss: 0.5192     60/Unknown - 15s 239ms/step - loss: 0.5160     61/Unknown - 15s 239ms/step - loss: 0.5127     62/Unknown - 16s 238ms/step - loss: 0.5098     63/Unknown - 16s 239ms/step - loss: 0.5069     64/Unknown - 16s 238ms/step - loss: 0.5036     65/Unknown - 16s 238ms/step - loss: 0.5002     66/Unknown - 17s 237ms/step - loss: 0.4973     67/Unknown - 17s 237ms/step - loss: 0.4941     68/Unknown - 17s 237ms/step - loss: 0.4913     69/Unknown - 17s 236ms/step - loss: 0.4881